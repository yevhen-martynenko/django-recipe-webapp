{% extends "../base.html" %}
{% load asset_tags %}


{% block title %}{{ title }}{% endblock title %}
{% block page_styles %}
<link rel="stylesheet" href="{% asset_tags 'feedback.css' %}">
{% endblock page_styles %}


{% block content %}
<div class="container">
    <main class="feedback" role="main">
        <h1 class="feedback-title">Submit Your Feedback</h1>
        
        <!-- Feedback Form -->
        <section class="feedback-form" aria-labelledby="feedback-form-title">
            <div id="feedback-success" class="feedback-form__success" style="display: none;" role="alert" aria-live="polite">
                Thank you! Your feedback has been submitted successfully.
            </div>

            <form id="feedback-form" novalidate>
                <div class="feedback-form__field">
                    <label for="feedback-type" class="feedback-form__label">
                        Feedback Type
                    </label>
                    <select 
                        id="feedback-type" 
                        name="feedbackType" 
                        class="feedback-form__select" 
                        required aria-describedby="feedback-type-error"
                    >
                        <option value="" disabled selected>Select Type</option>
                        <option value="bug">Bug Report</option>
                        <option value="suggestion">Suggestion</option>
                        <option value="general">General Feedback</option>
                        <option value="compliment">Compliment</option>
                        <option value="question">Question</option>
                    </select>
                    <div id="feedback-type-error" class="feedback-form__error" role="alert"></div>
                </div>

                <div class="feedback-form__field">
                    <label for="feedback-subject" class="feedback-form__label">
                        Subject
                    </label>
                    <input 
                        type="text" 
                        id="feedback-subject" 
                        name="subject" 
                        class="feedback-form__input"
                        placeholder="Brief summary of your feedback"
                        required
                        maxlength="100"
                        aria-describedby="feedback-subject-error"
                    >
                    <div id="feedback-subject-error" class="feedback-form__error" role="alert"></div>
                </div>

                <div class="feedback-form__field">
                    <label for="feedback-message" class="feedback-form__label">
                        Message
                    </label>
                    <textarea 
                        id="feedback-message" 
                        name="message" 
                        class="feedback-form__textarea"
                        placeholder="Detailed feedback..."required
                        maxlength="1000"
                        aria-describedby="feedback-message-error"
                    ></textarea>
                    <div id="feedback-message-error" class="feedback-form__error" role="alert"></div>
                </div>

                <div class="feedback-form__field">
                    <label for="contact-email" class="feedback-form__label optional">
                        Contact Email
                    </label>
                    <input 
                        type="email" 
                        id="contact-email" 
                        name="email" 
                        class="feedback-form__input"
                        placeholder="your@email.com"
                        aria-describedby="contact-email-error"
                    >
                    <div id="contact-email-error" class="feedback-form__error" role="alert"></div>
                </div>

                <button 
                    type="submit" 
                    class="btn feedback-form__button"
                    id="submit-button"
                >
                    Submit Feedback
                </button>
            </form>
        </section>

        <!-- Feedback History -->
        {% if feedbacks %}
        <section class="feedback-history" aria-labelledby="feedback-history-title">
            <h2 id="feedback-history-title" class="feedback-section__title">Your Past Feedback</h2>
            
            <div id="feedback-history-list">
                {% for feedback in feedbacks %}
                <article class="feedback-history__item">
                    <div class="feedback-history__header">
                        <span class="feedback-history__type feedback-history__type--{{ feedback.type_slug }}">{{ feedback.type }}</span>
                        <time class="feedback-history__date" datetime="{{ feedback.date_iso }}">{{ feedback.date }}</time>
                    </div>
                    <h3 class="feedback-history__title">{{ feedback.subject }}</h3>
                    <p class="feedback-history__description">
                        {{ feedback.message }}
                    </p>
                </article>
                {% endfor %}
            </div>
        </section>
        {% endif %}
    </main>
</div>
{% endblock content %}


{% block page_scripts %}
<script defer src="{% asset_tags 'feedback.js' %}"></script>
{% endblock page_scripts %}
